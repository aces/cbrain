
<%

#
# CBRAIN Project
#
# Original author: Pierre Rioux
#
# $Id$
#

-%>
<div class = "generalcontent">

  <% title 'Execution Servers' %>

  <div class = 'help_button_drop_down'>
           <% button_with_dropdown_menu(:title => "Help") do %>
             <a class = "overlay_link" data-url ="/doc/server/view_server.html">Execution Servers</a>
           <% end %>     
  </div>
  
  <% if check_role(:admin) || check_role(:site_manager)%>
      <div class="menu_bar">
          <% button_with_dropdown_menu({:title => 'Create New Server', :partial => 'new'}, {:id => "new_bourreau_button"}) %>
          <%= link_to "Refresh SSH Public Keys", {:action  => :refresh_ssh_keys }, { :method  => :post, :class  => "button ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-button-text-icon" } %>
      </div> <!-- End class="menu_bar" -->

   <% end %>
   <br>
   <div id="show_details_link" style="display:inline;">
    <%= 
        link_to_function 'Show Details', {:class  => 'action_link', :id => "show_details_link"} do |page|
          page.select('.resource_details').each{ |el| el.show  }
          page['hide_details_link'].show
          page['show_details_link'].hide
        end 
        %>
    </div>
    <div id="hide_details_link" style="display:none;">
        <%= 
        link_to_function 'Hide Details', {:class  => 'action_link', :id =>'hide_details_link'} do |page|
          page.select('.resource_details').each{ |el| el.hide  }
          page['show_details_link'].show
          page['hide_details_link'].hide      
        end 
            %>
    </div>
    
   <div id = "bourreau_info">
  

    <table class="resource_list" id="bourreau_table">
         <tr>
             <th>Server Class</th>
             <th>Server Name</th>
             <th class="resource_details" style="display:none">Revision Numbers</th>
             <th class="resource_details" style="display:none">Owner</th>
             <th>Group</th>
             <th class="resource_details" style="display:none">Site</th>
             <th>Online?</th>
             <th>Alive?</th>
             <th>Workers?</th>
             <th>Load</th>
             <th class="resource_details" style="display:none">Description</th>
             <th colspan="4">Operations</th>
         </tr>

         <% for bour in @bourreaux %>
          <% ajax_element({:element  => "tr", :url => url_for(:action => :row_data, :id => bour.id)}, {:class  => "#{cycle('list-odd', 'list-even')} row_highlight", :id  => "bourreau_#{bour.id}"}) do %>
            <td colspan="15" class="loading_message">Checking <%= bour.name %>...</td>
          <% end %>
         <% end %>
     </table>
  
  </div>
</div>  <!-- End class="generalcontent" -->
