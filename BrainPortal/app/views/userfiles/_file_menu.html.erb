
<%-
#
# CBRAIN Project
#
# Copyright (C) 2008-2012
# The Royal Institution for the Advancement of Learning
# McGill University
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
-%>

<div class="menu_bar">
    <%= link_to "Upload File",{:action  => :new}, :class  => "button menu_button"%>
    <%= link_to "Select Tool","#", :class  => "button menu_button", :id => "toolSelectLink" %>


    <%= button_with_dropdown_menu("Update Attributes") do %>
        <h4>Tags</h4>
        <%= render :partial => 'userfiles/tag_table' %>
        <hr>
        <h4>Projects</h4>
        Change Project:
        <%= group_select('userfile[group_id]', {}, { :include_blank => "(select another project)" } ) %>
        <%= hijacker_submit_button("Update", :name => :update_projects, :url  => url_for(:action  => :update_multiple), :method  => :put, :class => "button") %>
        <P>
        Project Permission Update:
        <%= select(:userfile, :group_writable, [['Read Only', false],['Read/Write', true]]) %>
        <%= hijacker_submit_button("Update", :name => :update_permissions, :url  => url_for(:action  => :update_multiple), :method  => :put, :class => "button") %>
        <% if !current_user.has_role?(:normal_user) %>
          <hr>
          Change Owner:
          <%= user_select('userfile[user_id]', {}, { :include_blank => "(select another owner)" } ) %>
          <%= hijacker_submit_button("Update", :name => :update_owner, :url  => url_for(:action  => :update_multiple), :method  => :put, :class => "button") %>
        <% end %>
        <hr>
        Mark Or Unmark As Hidden (<%= hidden_icon %>):
        <%= select(:userfile, :hidden, [['Not Hidden', false],['Mark as Hidden', true]]) %>
        <%= hijacker_submit_button("Update", :name => :update_hidden, :url  => url_for(:action  => :update_multiple), :method  => :put, :class => "button") %>
        <hr>
        Mark Or Unmark As Immutable (<%= immutable_icon %>):
        <%= select(:userfile, :immutable, [['Not Immutable', false],['Mark as Immutable', true]]) %>
        <%= hijacker_submit_button("Update", :name => :update_immutable, :url  => url_for(:action  => :update_multiple), :method  => :put, :class => "button") %>
        <hr>
        Update Parent-Child Relationships:
        <%= hijacker_submit_button("Update",  :url  => url_for(:action  => :new_parent_child ),
                                                     :datatype => 'html',
                                                     :overlay => true,
                                                     :class => "button",
                                                     :method  => :get)
        %>
        <hr>
        Update File Type:
        <%= userfile_type_select(:file_type, {}, { :include_blank => "(select another file type)" } ) %>
        <%= hijacker_submit_button("Update", :name => :update_file_type, :url  => url_for(:action  => :update_multiple), :method  => :put, :class => "button") %>
        <hr>
        Start QC: <%=
                      hijacker_submit_button("Start", :url  => url_for(:controller => 'userfiles', :action => 'quality_control'),
                                                      :confirm  => "Please note that files must be synchronized locally for QC. \n\nContinue?",
                                                      :ajax_submit  => false,
                                                      :class => "button",
                                                      :method  => :post)
                  %>
        <hr>
        Cache Operations:<br/>
        <%= hijacker_submit_button("Synchronize Files Locally", :url  => url_for(:controller => 'userfiles', :action => 'sync_multiple', :operation => 'sync_local'), :ajax_submit  => false, :method  => :post, :class => "button") %>
        &nbsp;or&nbsp;
        <%= hijacker_submit_button("Mark Content As Newer", :url  => url_for(:controller => 'userfiles', :action => 'sync_multiple', :operation => 'all_newer'), :ajax_submit  => false, :method  => :post, :class => "button") %>
    <% end %>

    <%= button_with_dropdown_menu("Filters", :content_id => 'userfiles_filters') do %>
      <%= render :partial => 'userfiles/filters' %>
    <% end %>
    <span id="view_option_button">
      <%= render :partial => "userfiles/view_option_button" %>
    </span>
</div>

