 
<% if @userfile.num_files && @userfile.num_files > 0 %>
  <% form_for :userfile, @userfile, :url => { :controller => :userfiles, :action => :extract_from_collection }, :html => { :method => :post } do |f| %>
    <% if @userfile.is_a?(CivetCollection) && session[:full_civet_display] == 'on' %>
       <P><CENTER><%= link_to "Display full file list", edit_userfile_path(@userfile, :full_civet_display => 'off'), :class => 'action_link' %></CENTER>
       <%= render :partial => 'file_collection_civet_file_list', :locals  => {:subject  => @userfile.list_files} %>
    <% elsif @userfile.is_a?(CivetStudy) && session[:full_civet_display] == 'on' %>
          <P><CENTER><%= link_to "Display full file list", edit_userfile_path(@userfile, :full_civet_display => 'off'), :class => 'action_link' %></CENTER>
          <%= render :partial => 'file_collection_civet_study_file_list', :locals  => {:userfile  => @userfile} %>
    <% else %>
       <% if @userfile.is_a?(CivetCollection) || @userfile.is_a?(CivetStudy) %>
         <P><CENTER><%= link_to "Display CIVET file list", edit_userfile_path(@userfile, :full_civet_display => 'on'), :class => 'action_link' %></CENTER>
       <% end %>
       <%= render :partial => 'file_collection_plain_file_list' %>
    <% end %> <!-- End if   -->

    <% if @userfile.is_locally_synced? %>
      <%= submit_tag "Extract Files from Collection" %>
    <% end %>
  <% end %>
<% end %>  <!-- End if   -->

