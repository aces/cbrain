<tr id="message_display_<%= mess.id %>" class="<%= cycle("list-odd", "list-even") %> row_highlight">
  <td  class="<%= "#{mess.message_type}_display" unless mess.read? %> left_side">
    <%= 
      link_to_function Message.parse_markup( h(mess.header) ) do |page|
        page["message_table_details_#{mess.id}"].toggle
      end 
    %>
    <div id="message_table_details_<%= mess.id %>" style="display:none">
      <%= render :partial  => 'layouts/message_details', :locals  => {:mess  => mess} %>
    </div>
  </td>
  <td class="<%= "#{mess.message_type}_display" unless mess.read? %> middle">
    <%= to_localtime(mess.last_sent, :datetime) %>
  </td>
  <td class="<%= "#{mess.message_type}_display" unless mess.read? %> right_side">
    <% unless mess.read %>
    <%= link_to_remote  'Mark&nbsp;as&nbsp;Read',
                      {:url  => message_path(mess, :read  => true),
                       :method  => 'put',
                       :before  => "$$('#message_display_#{mess.id}').invoke('update', '<td colspan=\"11\" style=\"color:red; text-align:center;\">Updating...</td>');"
                       },
                      {:class => 'action_link'}
      %>
      &nbsp;&nbsp;&nbsp;&nbsp;          
      <td class="<%= "#{mess.message_type}_display" unless mess.read? %> right_side">
        <%= check_box_tag("message_ids[]", mess.id.to_s, false) %>
   </td>
   <% end %>      
   </td>
</tr>

